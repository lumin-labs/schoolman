<div class="row">
  <div class="col-md-2" ng-include="'views/_navstacked.html'"></div>

  <div class="col-md-10 marksheet" ng-controller="UserCtrl">
  <h3>{{data.user.fullname}}</h3>
  <div class="row">
  	<div class="col-md-7" style="border-right:solid 1px #ddd;">
  	  <h3>{{dict.user_profile}}</h3>

  		<form class="form-horizontal" role="form">
	  		<div class="form-group">
			    <label for="fullname" class="col-sm-3 control-label">{{dict.name}}</label>
			    <div class="col-sm-9 printonly">{{data.user.fullname}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="fullname" class="form-control" placeholder="{{dict.name}}" ng-readonly="!editing" ng-model="data.user.fullname">
			    </div>
			</div>

			<div class="form-group">
			    <label for="matricalno" class="col-sm-3 control-label">{{dict.matrical_number}}</label>
			    <div class="col-sm-9 printonly">{{data.user.matricalno}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="matricalno" class="form-control" placeholder="{{dict.matrical_number}}" ng-readonly="!editing" ng-model="data.user.matricalno">
			    </div>
			</div>

			<div class="form-group">
			    <label for="grade" class="col-sm-3 control-label">{{dict.grade}}</label>
			    <div class="col-sm-9 printonly">{{data.user.grade}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="grade" class="form-control" placeholder="{{dict.grade}}" ng-readonly="!editing" ng-model="data.user.grade">
			    </div>
			</div>

			<div class="form-group">
			    <label for="qualification" class="col-sm-3 control-label">{{dict.highest_qualification}}</label>
			    <div class="col-sm-9 printonly">{{data.user.qualification}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="qualification" class="form-control" placeholder="{{dict.highest_qualification}}" ng-readonly="!editing" ng-model="data.user.qualification">
			    </div>
			</div>

			<br>

			<div class="form-group">
			    <label for="dateofentry" class="col-sm-3 control-label">{{dict.entry_into_service}}</label>
			    <div class="col-sm-9 printonly">{{data.user.dateofentry | date:'dd-MM-yyyy'}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="dateofentry" 
			           class="form-control" 
			           placeholder="Date of Entry" 
			           ng-model="data.user.dateofentry"
			           ng-readonly="!editing"
			           type="date">
			    </div>
			</div>

			<div class="form-group">
			    <label for="lengthservice" class="col-sm-3 control-label">{{dict.length_of_service}}</label>
			    <div class="col-sm-9">{{data.serviceYears ? data.serviceYears : 0}} {{dict.years}}, {{data.serviceMonths ? data.serviceMonths : 0}} {{dict.months}}</div>
			</div>

			<div class="form-group">
			    <label for="retirement" class="col-sm-3 control-label">{{dict.date_of_retirement}}</label>
			    <div class="col-sm-9">{{data.retire.valueOf() ? data.retire : ''  | date:'dd MMM yyyy'}}</div>
			</div>

			<div class="form-group">
			    <label for="post" class="col-sm-3 control-label">{{dict.duty_post}}</label>
			    <div class="col-sm-9 printonly">{{data.user.post}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="post" class="form-control" placeholder="{{dict.duty_post}}" ng-readonly="!editing" ng-model="data.user.post">
			    </div>
			</div>

			<br>

			<div class="form-group">
			    <label for="birthdate" class="col-sm-3 control-label">{{dict.date_of_birth}}</label>
			    <div class="col-sm-9 printonly">{{data.user.birth | date:'dd-MM-yyyy'}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="birthdate" 
			           class="form-control" 
			           placeholder="{{dict.date_of_birth}}" 
			           ng-model="data.user.birth"
			           ng-readonly="!editing"
			           type="date">
			    </div>
			</div>

			<div class="form-group">
			    <label for="gender" class="col-sm-3 control-label">{{dict.sex}}</label>
			    <div class="col-sm-9 printonly">{{data.user.sex}}</div>
			    <div class="col-sm-9 noprint">
			      <div class="btn-group">
			        <button class="{{editing ? '' : 'disabled'}} btn btn-sm btn-default dropdown-toggle" 
			                data-toggle="dropdown">
			          <span>{{data.user.sex}}</span>
			          &nbsp;<span ng-if="editing" class="caret"></span>
			        </button>
			        <ul class="dropdown-menu">
			          <li ng-repeat="gender in ['Female', 'Male']">
			            <a ng-click="data.user.sex = gender">{{gender}}</a>
			          </li>
			        </ul>
			      </div>
			    </div>
			  </div>

			<div class="form-group">
			    <label for="maritalstatus" class="col-sm-3 control-label">{{dict.marital_status}}</label>
			    <div class="col-sm-9 printonly">{{data.user.maritalstatus}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="maritalstatus" class="form-control" placeholder="{{dict.marital_status}}" ng-readonly="!editing" ng-model="data.user.maritalstatus">
			    </div>
			</div>

			<div class="form-group">
			    <label for="subdivision" class="col-sm-3 control-label">{{dict.subdivision_of_origin}}</label>
			    <div class="col-sm-9 printonly">{{data.user.subdivision}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="subdivision" class="form-control" placeholder="{{dict.subdivision_of_origin}}" ng-readonly="!editing" ng-model="data.user.subdivision">
			    </div>
			</div>

			<div class="form-group">
			    <label for="division" class="col-sm-3 control-label">{{dict.division_of_origin}}</label>
			    <div class="col-sm-9 printonly">{{data.user.division}}</div>
			    <div class="col-sm-9 noprint">
			      <input id="division" class="form-control" placeholder="{{dict.division_of_origin}}" ng-readonly="!editing" ng-model="data.user.division">
			    </div>
			</div>

			<br>
		  	<div class="form-group noprint" 
		  			ng-if="(data.user.access['admin'] === 1 || accessCode === 'admin' || accessCode === 'sales') && !editing">
			    <div class="col-sm-offset-3 col-sm-10">
			      <button type="submit" class="btn btn-info" ng-click="edit()">
			        {{dict.edit_user}}
			      </button>
			    </div>
		  	</div>
		  	<div class="form-group noprint" 
		  			ng-if="(data.user.access['admin'] === 1 || accessCode === 'admin' || accessCode === 'sales') && editing">
			    <div class="col-sm-offset-3 col-sm-10">
			      <button type="submit" class="btn btn-success" ng-click="save(data.user)">
			        {{dict.save_changes}}
			      </button>
			      <button type="submit" class="btn btn-warning" style="margin-left:15px;" ng-click="cancel()">
			        {{dict.cancel}}
			      </button>
			    </div>
		  	</div>
		</form>
  	</div>
  	<div class="col-md-5">
		<h3>{{dict.change_password}}</h3>
  	  <br>
  	  <form class="form-horizontal" role="form" ng-submit="savePassword()">
			  <div class="form-group" ng-if="data.user.username !== currentUser.username">
			    <label for="repeatpassword" class="col-sm-3 control-label">{{dict.your_password}}</label>
			    <div class="col-sm-9">
			      <input id="repeatpassword"
			           class="form-control"
			           type="password"
			           placeholder="{{dict.your_password}}" 
			           ng-model="data.currentPassword">
			    </div>
			  </div>
			  <div class="form-group" ng-if="data.user.username === currentUser.username">
			    <label for="repeatpassword" class="col-sm-3 control-label">{{dict.current_password}}</label>
			    <div class="col-sm-9">
			      <input id="repeatpassword"
			           class="form-control"
			           type="password"
			           placeholder="{{dict.current_password}}" 
			           ng-model="data.currentPassword">
			    </div>
			  </div>
			  <br>
			  <div class="form-group {{data.newPassword.length > 5 ? 'has-success' : ''}}">
			    <label for="userFullname" class="col-sm-3 control-label">{{dict.new_password}}</label>
			    <div class="col-sm-9">
			      <input id="userFullname"
			           class="form-control" 
			           type="password"
			           placeholder="{{dict.new_password}}"
			           ng-model="data.newPassword">
			    </div>
			  </div>
			  <div class="form-group {{data.verifiedStatus}}">
			    <label for="verifypassword" class="col-sm-3 control-label">{{dict.type_it_again}}</label>
			    <div class="col-sm-9">
			      <input id="verifypassword"
			           class="form-control"
			           type="password"
			           placeholder="{{dict.new_password}}" 
			           ng-model="data.repeatPassword"
			           ng-change="verifyStatus()"
			           ng-blur="verifyMatch()">
			    </div>
			  </div>
			  <div class="form-group">
			    <label for="submit" class="col-sm-3 control-label"></label>
			    <div class="col-sm-9">
			  		<div ng-if="status === 401" style="color:red;">{{dict.incorrect_password}}</div>
			  		<br>
			      <button type="submit" 
			              class="btn btn-default 
			                     {{data.newPassword.length < 6 ||
			                       data.repeatPassword.length < data.newPassword.length ||
			                       data.verifiedStatus === 'has-error' ? 'disabled' : ''}}"
			              ng-if="status !== 200">{{dict.submit}}</button>
			      <button type="submit" 
			              class="btn btn-success disabled"
			              ng-if="status === 200">{{dict.saved}}</button>
			    </div>
			  </div>
    		
			</form>
  	</div>
  </div>
  </div>
	
</div>	

